{"version":3,"file":"login-e02e41f2.js","sources":["../../../../pages/login.vue"],"sourcesContent":["<template>\r\n\r\n  <div class=\"row mt-4\">\r\n\r\n    <div class=\"col-lg-6 mx-auto\" style=\"margin-top: 150px\">\r\n      <div class=\"card border-0 shadow\">\r\n        <div class=\"card-body pb-5\">\r\n          <h6 class=\"d-inline-block pb-2 mb-2\">ورود به سایت</h6>\r\n          <div id=\"mobileForm\">\r\n            <div class=\"row d-flex justify-content-start\" style=\"padding-right: 11px; padding-left: 11px\">\r\n              <div class=\"col-6\">\r\n                <button id=\"user\" @click=\"selectScope('user')\" class=\"w-100 btn btn-sm btn-primary me-2 mb-2\">کارجو\r\n                </button>\r\n              </div>\r\n              <div class=\"col-6\">\r\n                <button id=\"company\" @click=\"selectScope('company')\" class=\"w-100 btn btn-sm btn-outline-primary me-2 mb-2\">\r\n                  کارفرما\r\n                </button>\r\n              </div>\r\n\r\n            </div>\r\n\r\n            <div class=\"input-group mt-2 mb-3 px-1\">\r\n              <input type=\"text\" class=\"form-control form-control-sm\" minlength=\"11\" maxlength=\"11\" id=\"mobile\"\r\n                     placeholder=\"شماره موبایل\" aria-label=\"Recipient's username\" aria-describedby=\"button-addon2\">\r\n              <button class=\"btn btn-sm btn-outline-primary\" type=\"button\" id=\"button-addon2\" @click=\"getCode\">دریافت کد\r\n                تایید\r\n              </button>\r\n\r\n            </div>\r\n            <li v-for=\"item in message\"><small>{{ item }}</small></li>\r\n          </div>\r\n\r\n\r\n          <div id=\"codeForm\" class=\"d-none\">\r\n            <small>کد تایید به شماره <span class=\"fw-bold text-primary\">{{ mobile }}</span> پیامک شد. لطفا آنرا وارد کنید</small>\r\n\r\n            <div class=\"d-flex justify-content-between mt-3\" dir=\"ltr\">\r\n              <input type=\"text\" id=\"code1\" @input=\"autoTab($event)\"\r\n                     class=\"form-control form-control-sm mx-1 text-center\" minlength=\"1\" maxlength=\"1\">\r\n              <input type=\"text\" id=\"code2\" @input=\"autoTab($event)\"\r\n                     class=\"form-control form-control-sm mx-1 text-center\" minlength=\"1\" maxlength=\"1\">\r\n              <input type=\"text\" id=\"code3\" @input=\"autoTab($event)\"\r\n                     class=\"form-control form-control-sm mx-1 text-center\" minlength=\"1\" maxlength=\"1\">\r\n              <input type=\"text\" id=\"code4\" @input=\"autoTab($event)\"\r\n                     class=\"form-control form-control-sm mx-1 text-center\" minlength=\"1\" maxlength=\"1\">\r\n            </div>\r\n\r\n            <div class=\"row mt-3\" style=\"padding-right: 11px; padding-left: 11px\">\r\n              <div class=\"col-6\">\r\n                <button id=\"editNumber\" @click=\"editno\" class=\"w-100 btn btn-sm btn-outline-primary me-2 mb-2\">تصحیح شماره\r\n                </button>\r\n              </div>\r\n              <div class=\"col-6\">\r\n                <button disabled id=\"resend\" @click=\"resend\" class=\" w-100 btn btn-sm btn-outline-primary me-2 mb-2\">\r\n                  ارسال مجدد کد\r\n                  <span id=\"time\">{{ time }}</span>\r\n                </button>\r\n              </div>\r\n\r\n            </div>\r\n          </div>\r\n\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios';\r\nimport {ref, onMounted} from 'vue';\r\n\r\nexport default {\r\n  setup() {\r\n    const scope= ref('user');\r\n    const message= ref([]);\r\n    const mobile = ref();\r\n    const time = ref(59);\r\n    onMounted(() => {\r\n      document.getElementById(\"code1\").value = '';\r\n      document.getElementById(\"code2\").value = '';\r\n      document.getElementById(\"code3\").value = '';\r\n      document.getElementById(\"code4\").value = '';\r\n    });\r\n    const selectScope = (id) => {\r\n     scope.value = id;\r\n      if(id == 'user') {\r\n        document.getElementById('user').classList.add('btn-primary');\r\n            document.getElementById('user').classList.remove('btn-outline-primary');\r\n            document.getElementById('company').classList.remove('btn-primary');\r\n            document.getElementById('company').classList.add('btn-outline-primary');\r\n\r\n      }else if (id == 'company'){\r\n\r\n            document.getElementById('user').classList.remove('btn-primary');\r\n            document.getElementById('user').classList.add('btn-outline-primary');\r\n            document.getElementById('company').classList.add('btn-primary');\r\n            document.getElementById('company').classList.remove('btn-outline-primary');\r\n\r\n      }\r\n\r\n\r\n    }\r\n    const getCode = () => {\r\n\r\n      message.value = [];\r\n       mobile.value = document.getElementById('mobile').value;\r\n      if (mobile.value.length  < 11){\r\n        message.value.push('شماره موبایل باید 11 رقم باشد');\r\n      }\r\n      if(!mobile.value.startsWith('09')){\r\n        message.value.push('شماره موبایل باید با 09 شروع شود');\r\n      }\r\n      if(mobile.value.length === 11 && mobile.value.startsWith('09'))\r\n        message.value = [];\r\n      axios.post('http://127.0.0.1:8000/api/otp/mobile', {\r\n        mobile: document.getElementById('mobile').value,\r\n        scope: scope.value\r\n      }, {progress: false})\r\n          .then((res) => {\r\n            if (res.status === 200) {\r\n              document.getElementById('mobileForm').classList.add('d-none');\r\n              document.getElementById('codeForm').classList.remove('d-none');\r\n            }else{\r\n              // message.value = res;\r\n              console.log(res)\r\n            }\r\n          })\r\n          .then(()=>{\r\n            document.getElementById('resend').setAttribute('disabled', 'disabled')\r\n            counter();\r\n            setTimeout(()=>{\r\n                document.getElementById('resend').removeAttribute('disabled')\r\n            },60000)\r\n          })\r\n          .catch((err) => {\r\n        message.value = err.response.data.message;\r\n      })\r\n    }\r\n\r\n    const editno = ()=>{\r\n      document.getElementById('mobileForm').classList.remove('d-none');\r\n      document.getElementById('codeForm').classList.add('d-none');\r\n    }\r\n    const resend = ()=>{\r\n\r\n      getCode();\r\n    }\r\n    const counter=()=> {\r\n\r\n      var distance = 59;\r\n      var x = null;\r\n      clearInterval(x);\r\n      time.value = 0;\r\n       x = setInterval(function () {\r\n\r\n        // document.getElementById(\"time\").classList.remove('d-none');\r\n\r\n\r\n        distance--;\r\n        time.value = distance;\r\n        var t = time.value  < 10 ? \"0\" : \"\";\r\n        document.getElementById(\"time\").innerHTML = t + time.value ;\r\n\r\n        if (distance < 1) {\r\n          clearInterval(x);\r\n          // document.getElementById(\"time\").classList.add('d-none');\r\n\r\n        }\r\n      }, 1000);\r\n\r\n      time.value = 0;\r\n      // if(time.value === 0){\r\n      //   document.getElementById('resend').removeAttribute('disabled')\r\n      // }\r\n\r\n    }\r\n    const autoTab = (e) => {\r\n      let code =\r\n          document.getElementById(\"code1\").value +\r\n          document.getElementById(\"code2\").value +\r\n          document.getElementById(\"code3\").value +\r\n          document.getElementById(\"code4\").value;\r\n\r\n      if (code.length == 4) {\r\n\r\n        axios.post('http://127.0.0.1:8000/api/mobile/login', {\r\n          mobile: document.getElementById('mobile').value,\r\n          scope: scope.value,\r\n          password: document.getElementById(\"code1\").value + document.getElementById(\"code2\").value + document.getElementById(\"code3\").value + document.getElementById(\"code4\").value\r\n        }, {progress: false})\r\n            .then((res) => {\r\n              if (res.status === 200) {\r\n                localStorage.setItem('user',JSON.stringify(res.data.user))\r\n                localStorage.setItem('token',JSON.stringify(res.data.access_token))\r\n                localStorage.setItem('scope',JSON.stringify(res.data.scope))\r\n                localStorage.setItem('expire',JSON.stringify(res.data.expire));\r\n                console.log(localStorage)\r\n                window.location = '/';\r\n              }else{\r\n                console.log(res)\r\n              }\r\n            }).catch((err) => {\r\n          message.value = err.response.data.message;\r\n        })\r\n\r\n      }\r\n\r\n      if (e.target.value.length === e.target.maxLength) {\r\n        e.target.nextElementSibling?.focus();\r\n      }\r\n    }\r\n\r\n    return {\r\n      autoTab, selectScope, getCode, scope, message, mobile, counter, time, resend,editno\r\n    }\r\n  }\r\n}\r\n\r\n</script>\r\n\r\n<style>\r\n\r\n</style>"],"names":["_ssrRenderAttrs","_mergeProps","_ssrRenderList"],"mappings":";;;;;;;;;;;;;;;;AAyEA,MAAA,YAAA;AAAA,EACE,QAAA;;AAEE,UAAA,UAAA,IAAA,CAAA,CAAA;AACA,UAAA,SAAA;AACoB,UAAA,OAAA,IAAA,EAAA;;AAQnB,YAAA,QAAA;AACC,UAAA,MAAA,QAAA;;AAEM,iBAAA,eAAA,MAAA,EAAA,UAAA,OAAA,qBAAA;AACA,iBAAA,eAAA,SAAA,EAAA,UAAA,OAAA,aAAA;AACA,iBAAA,eAAA,SAAA,EAAA,UAAA,IAAA,qBAAA;AAAA;AAIA,iBAAA,eAAA,MAAA,EAAA,UAAA,OAAA,aAAA;AACA,iBAAA,eAAA,MAAA,EAAA,UAAA,IAAA,qBAAA;AACA,iBAAA,eAAA,SAAA,EAAA,UAAA,IAAA,aAAA;AACA,iBAAA,eAAA,SAAA,EAAA,UAAA,OAAA,qBAAA;AAAA,MAEN;AAAA,IAGF;AACA,UAAA,UAAA,MAAA;AAEE,cAAA,QAAA;;;;MAIA;AACA,UAAA,CAAA,OAAA,MAAA,WAAA,IAAA,GAAA;;MAEA;;AAEE,gBAAA,QAAA;;;QAGA,OAAA,MAAA;AAAA,MACF,GAAA,EAAA,UAAA,MAAA,CAAA;AAEM,YAAA,IAAA,WAAA,KAAA;;AAEE,mBAAA,eAAA,UAAA,EAAA,UAAA,OAAA,QAAA;AAAA;AAGA,kBAAA,IAAA,GAAA;AAAA,QACF;AAAA;AAGA,iBAAA,eAAA,QAAA,EAAA,aAAA,YAAA,UAAA;AACA;AACA,mBAAA,MAAA;;QAEA,GAAA,GAAA;AAAA,SAEF,MAAA,CAAA,QAAA;AACF,gBAAA,QAAA,IAAA,SAAA,KAAA;AAAA;IAEJ;AAEA,UAAA,SAAA,MAAA;AACE,eAAA,eAAA,YAAA,EAAA,UAAA,OAAA,QAAA;;IAEF;AACA,UAAA,SAAA,MAAA;AAEE;IACF;AACA,UAAA,UAAA,MAAA;AAEE,UAAA,WAAA;AACA,UAAA,IAAA;AACA,oBAAA,CAAA;;;;AAQE,aAAA,QAAA;;;AAIA,YAAA,WAAA,GAAA;AACE,wBAAA,CAAA;AAAA,QAGF;AAAA,MACF,GAAA,GAAA;;IAOF;AACA,UAAA,UAAA,CAAA,MAAA;;AACE,UAAA,OACI,SAAA,eAAA,OAAA,EAAA,QACA,SAAA,eAAA,OAAA,EAAA,QACA,SAAA,eAAA,OAAA,EAAA,QACA,SAAA,eAAA,OAAA,EAAA;AAEJ,UAAA,KAAA,UAAA,GAAA;;;UAII,OAAA,MAAA;AAAA,UACA,UAAA,SAAA,eAAA,OAAA,EAAA,QAAA,SAAA,eAAA,OAAA,EAAA,QAAA,SAAA,eAAA,OAAA,EAAA,QAAA,SAAA,eAAA,OAAA,EAAA;AAAA,QACF,GAAA,EAAA,UAAA,MAAA,CAAA;AAEM,cAAA,IAAA,WAAA,KAAA;;AAEE,yBAAA,QAAA,SAAA,KAAA,UAAA,IAAA,KAAA,YAAA,CAAA;;AAEA,yBAAA,QAAA,UAAA,KAAA,UAAA,IAAA,KAAA,MAAA,CAAA;;AAEA,mBAAA,WAAA;AAAA;AAEA,oBAAA,IAAA,GAAA;AAAA,UACF;AAAA,QACF,CAAA,EAAA,MAAA,CAAA,QAAA;AACF,kBAAA,QAAA,IAAA,SAAA,KAAA;AAAA;MAGJ;;AAGE,gBAAA,OAAA,uBAAA,mBAAA;AAAA,MACF;AAAA,IACF;AAEA,WAAA;AAAA,MACE;AAAA,MAAA;AAAA,MAAA;AAAA,MAAA;AAAA,MAAA;AAAA,MAAA;AAAA,MAAA;AAAA,MAAA;AAAA,MAAA;AAAA,MAAA;AAAA,IACF;AAAA,EACF;AACF;;eAxNOA,eAAAC,WAAA,EAAA,OAAA,WAAA,GAAA,MAAA,CAAA;AA4BwBC,gBAAA,OAAA,SAAA,CAAA,SAAA;;;;;;;;;;;;"}